import React, {Component} from 'react'
import {UIManager} from 'react-native'

export function FocusableRef(WrappedComponent) {
  return class extends React.Component {
    constructor(props) {
      super(props);
    }

    focus() {
      if (this.tag) {
        UIManager.focus(this.tag)
      } else {
        console.warn("Can't focus: tag not set!");
      }
    }

    render() {
      return (
        <WrappedComponent
          {...this.props}
          ref={(ref) => {
            this.ref = ref
            this.props.ref && this.props.ref(this)
          }}
          onLoad={(event) => {
            this.tag = event.nativeEvent.tag
            const {onLoad} = this.props
            onLoad && onLoad(this)
          }}
          focusable={this.props.focusable}
        />
      );
    }
  }
}